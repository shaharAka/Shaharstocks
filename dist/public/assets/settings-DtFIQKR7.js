import{c as se,c6 as oe,c7 as me,c8 as he,c9 as ue,ca as xe,cb as ye,d as te,r as l,u as z,e as M,j as e,H as pe,C as y,f as v,g as S,a1 as fe,z as ve,a8 as L,h as T,V as u,W as N,B as f,cc as ee,v as Q,q as j,b as O,a as Ne,p as be,cd as we,s as Ce,G as Se,ce as ne,a3 as ie,k as Te}from"./index-DI4YInPS.js";import{S as J}from"./skeleton-DV0SbO6m.js";import{S as G}from"./switch-DQ4dWgf9.js";import{C as ke,e as Fe,S as re,a as ce,b as le,c as de,d as Z}from"./select-CpnPcG5S.js";import{S as De}from"./send-DjLmzuOp.js";import"./index-B-eDo8U8.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=se("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=se("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=se("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);function Ie(n,r){const a=oe(n);return isNaN(r)?me(n,NaN):(a.setDate(a.getDate()+r),a)}function Me(n,r){const a=+oe(n);return me(n,a+r)}function Le(n,r){return Me(n,r*he)}function Oe(n,r,a){const d=ue(n,r)/he;return xe(a==null?void 0:a.roundingMethod)(d)}function Re(n,r,a){const d=ue(n,r)/ye;return xe(a==null?void 0:a.roundingMethod)(d)}function Qe(){const{toast:n}=te(),[r,a]=l.useState(""),[d,m]=l.useState(""),[k,F]=l.useState(!0),[x,R]=l.useState(""),[g,D]=l.useState(""),[b,A]=l.useState(""),[V,$]=l.useState("idle"),[P,H]=l.useState([]),[U,Y]=l.useState(!1),E=(s,o,p,_)=>{const K={timestamp:new Date().toISOString(),source:s,action:o,details:p,data:_};H(je=>[K,...je].slice(0,50))},B=()=>{const s=P.map(o=>{let p=`[${new Date(o.timestamp).toLocaleString()}] ${o.source.toUpperCase()} - ${o.action.toUpperCase()}: ${o.details}`;return o.data&&(p+=`
Data: ${JSON.stringify(o.data,null,2)}`),p}).join(`

`+"=".repeat(80)+`

`);navigator.clipboard.writeText(s),n({title:"Logs copied",description:"Fetch logs have been copied to clipboard"})},W=()=>{H([]),n({title:"Logs cleared",description:"All fetch logs have been cleared"})},{data:c}=z({queryKey:["/api/feature-flags"]}),{data:h,isLoading:ae}=z({queryKey:["/api/telegram/config"],retry:!1,enabled:(c==null?void 0:c.enableTelegram)??!1}),{data:w}=z({queryKey:["/api/telegram/status"],enabled:(c==null?void 0:c.enableTelegram)??!1});l.useEffect(()=>{h&&(a(h.channelUsername||""),m(h.phoneNumber||""),F(h.enabled??!0))},[h]);const i=M({mutationFn:async()=>await(await O("POST","/api/telegram/config",{channelUsername:r,phoneNumber:d||void 0,enabled:k})).json(),onSuccess:()=>{j.invalidateQueries({queryKey:["/api/telegram/config"]}),j.invalidateQueries({queryKey:["/api/telegram/status"]}),n({title:"Settings saved",description:"Your Telegram configuration has been updated successfully."})},onError:()=>{n({title:"Error",description:"Failed to save Telegram configuration.",variant:"destructive"})}}),q=M({mutationFn:async(s=10)=>{E("telegram","attempt",`Attempting to fetch ${s} messages`,{limit:s});try{const p=await(await O("POST","/api/telegram/fetch",{limit:s})).json();return E("telegram","success",`Successfully fetched ${p.messagesFetched||0} messages`,p),p}catch(o){throw E("telegram","error",`Fetch failed: ${o.message}`,{error:o.toString(),stack:o.stack}),o}},onSuccess:s=>{j.invalidateQueries({queryKey:["/api/stocks"]}),n({title:"Messages fetched successfully",description:s.message||`Fetched ${s.messagesFetched} messages`})},onError:s=>{n({title:"Error",description:s.message||"Failed to fetch Telegram messages.",variant:"destructive"})}}),I=M({mutationFn:async()=>await(await O("POST","/api/telegram/auth/send-code",{phoneNumber:x})).json(),onSuccess:s=>{D(s.phoneCodeHash),$("code-sent"),n({title:"Code sent",description:"Check your Telegram app for the verification code."})},onError:s=>{n({title:"Error",description:s.message||"Failed to send verification code.",variant:"destructive"})}}),C=M({mutationFn:async()=>await(await O("POST","/api/telegram/auth/sign-in",{phoneNumber:x,phoneCode:b,phoneCodeHash:g})).json(),onSuccess:()=>{$("authenticated"),j.invalidateQueries({queryKey:["/api/telegram/status"]}),n({title:"Authentication successful",description:"You can now fetch messages from Telegram channels."}),R(""),A(""),D("")},onError:s=>{n({title:"Error",description:s.message||"Failed to verify code.",variant:"destructive"})}}),X=s=>{s.preventDefault(),i.mutate()},t=()=>{q.mutate(100)};return e.jsxs("div",{className:"p-6 space-y-6 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"h-5 w-5 text-primary"}),e.jsx("h1",{className:"text-xl font-semibold whitespace-nowrap","data-testid":"text-page-title",children:"Fetch Configuration"})]}),(c==null?void 0:c.enableTelegram)&&w&&e.jsx(y,{children:e.jsx(v,{children:e.jsx(S,{className:"flex items-center gap-2 text-base",children:w.isConnected?e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"h-5 w-5 text-green-600"}),e.jsx("span",{children:"Connected to Telegram"})]}):e.jsxs(e.Fragment,{children:[e.jsx(ve,{className:"h-5 w-5 text-red-600"}),e.jsx("span",{children:"Not Connected"})]})})})}),(c==null?void 0:c.enableTelegram)&&!(w!=null&&w.isConnected)&&e.jsxs(y,{"data-testid":"card-telegram-auth",children:[e.jsxs(v,{children:[e.jsx(S,{children:"Authenticate with Telegram"}),e.jsx(L,{children:"Enter your phone number to receive a verification code via Telegram"})]}),e.jsx(T,{children:e.jsxs("div",{className:"space-y-4",children:[V==="idle"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"auth-phone",children:"Phone Number"}),e.jsx(N,{id:"auth-phone",type:"tel",placeholder:"+1234567890",value:x,onChange:s=>R(s.target.value),"data-testid":"input-auth-phone"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Include country code (e.g., +1 for USA)"})]}),e.jsx(f,{onClick:()=>I.mutate(),disabled:!x||I.isPending,"data-testid":"button-send-code",children:I.isPending?"Sending...":"Send Verification Code"})]}),V==="code-sent"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-muted rounded-md",children:e.jsxs("p",{className:"text-sm",children:["Verification code sent to ",e.jsx("strong",{children:x})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"verification-code",children:"Verification Code"}),e.jsx(N,{id:"verification-code",type:"text",placeholder:"12345",value:b,onChange:s=>A(s.target.value),"data-testid":"input-verification-code"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Check your Telegram app for the code"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(f,{onClick:()=>C.mutate(),disabled:!b||C.isPending,"data-testid":"button-verify-code",children:C.isPending?"Verifying...":"Verify Code"}),e.jsx(f,{variant:"outline",onClick:()=>{$("idle"),A(""),D("")},"data-testid":"button-cancel-auth",children:"Cancel"})]})]})]})})]}),(c==null?void 0:c.enableTelegram)&&e.jsxs(y,{"data-testid":"card-telegram-config",children:[e.jsxs(v,{children:[e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(De,{className:"h-5 w-5"}),"Telegram Configuration"]}),e.jsx(L,{children:"Monitor a Telegram channel directly for insider trading notifications"})]}),e.jsx(T,{children:ae?e.jsxs("div",{className:"space-y-4",children:[e.jsx(J,{className:"h-20 w-full"}),e.jsx(J,{className:"h-20 w-full"})]}):e.jsxs("form",{onSubmit:X,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"channel-username",children:"Channel Username *"}),e.jsx(N,{id:"channel-username",type:"text",placeholder:"InsiderTrading_SEC",value:r,onChange:s=>a(s.target.value),required:!0,"data-testid":"input-channel-username"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Telegram channel username (without the @ symbol)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"phone-number",children:"Phone Number (Optional)"}),e.jsx(N,{id:"phone-number",type:"tel",placeholder:"+1234567890",value:d,onChange:s=>m(s.target.value),"data-testid":"input-phone-number"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Your phone number for Telegram authentication (for reference only)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(G,{id:"enabled",checked:k,onCheckedChange:F,"data-testid":"switch-enabled"}),e.jsx(u,{htmlFor:"enabled",className:"cursor-pointer",children:"Enable channel monitoring"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(f,{type:"submit",disabled:i.isPending,"data-testid":"button-save-config",children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),i.isPending?"Saving...":"Save Configuration"]}),e.jsxs(f,{type:"button",variant:"outline",onClick:t,disabled:q.isPending||!r,"data-testid":"button-fetch-now",children:[e.jsx(ee,{className:`h-4 w-4 mr-2 ${q.isPending?"animate-spin":""}`}),q.isPending?"Fetching...":"Fetch Messages"]})]})]})})]}),(c==null?void 0:c.enableTelegram)&&e.jsxs(y,{"data-testid":"card-telegram-info",children:[e.jsxs(v,{children:[e.jsx(S,{children:"How It Works"}),e.jsx(L,{children:"Direct Telegram integration using GramJS"})]}),e.jsxs(T,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Direct Connection"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["The system connects directly to Telegram using your API credentials and monitors the ",e.jsxs("span",{className:"font-mono",children:["@",r||"InsiderTrading_SEC"]})," channel in real-time."]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Message Processing"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"New messages from the channel are automatically parsed to extract:"}),e.jsxs("ul",{className:"text-xs text-muted-foreground list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Stock ticker symbols"}),e.jsx("li",{children:"Company names"}),e.jsx("li",{children:"Insider trading information"}),e.jsx("li",{children:"Transaction details"})]})]}),(h==null?void 0:h.lastSync)&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Last Sync"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(h.lastSync).toLocaleString()})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:"API Credentials"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Your Telegram API credentials (API ID and API Hash) are securely stored as environment variables."})]})]})]}),e.jsx($e,{addLog:E}),e.jsx(Ae,{}),e.jsxs(y,{"data-testid":"card-fetch-logs",children:[e.jsx(v,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(S,{children:"Fetch Logs"}),e.jsx(L,{children:"Debug fetch attempts and errors (last 50 entries)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[P.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs(f,{variant:"outline",size:"sm",onClick:B,"data-testid":"button-copy-logs",children:[e.jsx(Pe,{className:"h-4 w-4 mr-2"}),"Copy Logs"]}),e.jsx(f,{variant:"outline",size:"sm",onClick:W,"data-testid":"button-clear-logs",children:"Clear"})]}),e.jsx(f,{variant:"ghost",size:"sm",onClick:()=>Y(!U),"data-testid":"button-toggle-logs",children:U?e.jsx(ke,{className:"h-4 w-4"}):e.jsx(Fe,{className:"h-4 w-4"})})]})]})}),U&&e.jsx(T,{children:P.filter(s=>s.source!=="openinsider").length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No logs yet. Logs will appear here when you attempt to fetch data."}):e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:P.filter(s=>s.source!=="openinsider").map((s,o)=>e.jsxs("div",{className:`p-3 rounded text-xs font-mono border ${s.action==="error"?"bg-destructive/10 border-destructive":s.action==="success"?"bg-success/10 border-success":"bg-muted border-border"}`,"data-testid":`log-entry-${o}`,children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{variant:s.source==="telegram"?"default":"secondary",children:s.source.toUpperCase()}),e.jsx(Q,{variant:s.action==="error"?"destructive":s.action==="success"?"default":"outline",children:s.action.toUpperCase()})]}),e.jsx("span",{className:"text-muted-foreground text-[10px]",children:new Date(s.timestamp).toLocaleString()})]}),e.jsx("p",{className:"text-foreground/90 mb-2",children:s.details}),s.data&&e.jsxs("details",{className:"mt-2",children:[e.jsx("summary",{className:"cursor-pointer text-muted-foreground hover:text-foreground",children:"View data"}),e.jsx("pre",{className:"mt-2 p-2 bg-background rounded overflow-x-auto text-[10px]",children:JSON.stringify(s.data,null,2)})]})]},o))})})]})]})}function Ae(){const{toast:n}=te(),[r,a]=l.useState(!1),{data:d}=z({queryKey:["/api/auth/current-user"]}),m=d==null?void 0:d.user;l.useEffect(()=>{(m==null?void 0:m.showAllOpportunities)!==void 0&&a(m.showAllOpportunities)},[m==null?void 0:m.showAllOpportunities]);const k=M({mutationFn:async x=>{if(!m)throw new Error("Not authenticated");return await(await O("PATCH",`/api/users/${m.id}`,{showAllOpportunities:x})).json()},onSuccess:()=>{j.invalidateQueries({queryKey:["/api/auth/current-user"]}),j.invalidateQueries({queryKey:["/api/user"]}),n({title:"Preference saved",description:"Your display preference has been updated"})},onError:()=>{n({title:"Error",description:"Failed to save preference",variant:"destructive"})}}),F=x=>{a(x),k.mutate(x)};return m?e.jsxs(y,{"data-testid":"card-display-preferences",children:[e.jsxs(v,{children:[e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"h-5 w-5"}),"Display Preferences"]}),e.jsx(L,{children:"Configure how opportunities are displayed"})]}),e.jsx(T,{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(u,{htmlFor:"show-all-opportunities",className:"text-sm font-medium",children:"Show All Opportunities"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"When enabled, displays both BUY and SELL opportunities. When disabled (default), only BUY opportunities are shown."})]}),e.jsx(G,{id:"show-all-opportunities",checked:r,onCheckedChange:F,"data-testid":"switch-show-all-opportunities"})]})})]}):null}function $e({addLog:n}){const{toast:r}=te(),{user:a}=Ne(),[d,m]=l.useState(!1),[k,F]=l.useState(50),[x,R]=l.useState("hourly"),[g,D]=l.useState([]),[b,A]=l.useState(null),[V,$]=l.useState(500),[P,H]=l.useState(!1),[U,Y]=l.useState(15),[E,B]=l.useState(10),W=(a==null?void 0:a.subscriptionStatus)==="trial"||(a==null?void 0:a.subscriptionStatus)==="pending_verification",c=(a==null?void 0:a.subscriptionStatus)==="active",h=a!=null&&a.lastDataRefresh?new Date(a.lastDataRefresh):null,w=(()=>{if(!h)return{canRefresh:!0,nextRefreshTime:null,timeUntilRefresh:null};const t=new Date,s=c?Le(h,1):Ie(h,1);if(t>=s)return{canRefresh:!0,nextRefreshTime:null,timeUntilRefresh:null};const p=Re(s,t),_=Oe(s,t);let K;return p<60?K=`${p} minute${p!==1?"s":""}`:K=`${_} hour${_!==1?"s":""}`,{canRefresh:!1,nextRefreshTime:s,timeUntilRefresh:K}})(),{data:i,isLoading:q}=z({queryKey:["/api/openinsider/config"],retry:!1});l.useEffect(()=>{i&&(m(i.enabled??!1),F(i.fetchLimit||50),R(i.fetchInterval||"hourly"),D(i.insiderTitles||[]),A(i.minTransactionValue||null),$(i.minMarketCap??500),H(i.fetchPreviousDayOnly||!1),Y(i.optionsDealThresholdPercent??15),B(i.minCommunityEngagement??10))},[i]);const I=M({mutationFn:async()=>await(await O("POST","/api/openinsider/config",{enabled:d,fetchLimit:k,fetchInterval:x,insiderTitles:g.length>0?g:null,minTransactionValue:b&&b>0?b:null,minMarketCap:V,fetchPreviousDayOnly:P,optionsDealThresholdPercent:U,minCommunityEngagement:E})).json(),onSuccess:()=>{j.invalidateQueries({queryKey:["/api/openinsider/config"]}),j.invalidateQueries({queryKey:["/api/stocks"]}),r({title:"Settings saved",description:"Insider trading data configuration has been updated successfully."})},onError:()=>{r({title:"Error",description:"Failed to save insider trading data configuration.",variant:"destructive"})}}),C=M({mutationFn:async()=>await(await O("POST","/api/openinsider/fetch",{})).json(),onSuccess:t=>{j.invalidateQueries({queryKey:["/api/openinsider/config"]}),j.invalidateQueries({queryKey:["/api/stocks"]}),r({title:"Fetch successful",description:t.message||`Created ${t.created} new recommendations from ${t.total} transactions`})},onError:t=>{r({title:"Error",description:t.message||"Failed to fetch insider trading data.",variant:"destructive"})}}),X=t=>{t.preventDefault(),I.mutate()};return q?e.jsxs(y,{children:[e.jsx(v,{children:e.jsx(J,{className:"h-6 w-48"})}),e.jsx(T,{children:e.jsx(J,{className:"h-20 w-full"})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(y,{"data-testid":"card-openinsider-config",children:[e.jsxs(v,{children:[e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-5 w-5"}),"Insider Trading Data Configuration"]}),e.jsx(L,{children:"Fetch insider trading data from SEC regulatory filings"})]}),e.jsx(T,{children:e.jsxs("form",{onSubmit:X,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{id:"openinsider-enabled",checked:d,onCheckedChange:m,"data-testid":"switch-openinsider-enabled"}),e.jsx(u,{htmlFor:"openinsider-enabled",className:"cursor-pointer",children:"Enable insider trading data source"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"fetch-limit",children:"Transactions per fetch (1-500)"}),e.jsx(N,{id:"fetch-limit",type:"number",min:"1",max:"500",value:k,onChange:t=>F(parseInt(t.target.value)||50),disabled:!d,"data-testid":"input-fetch-limit"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Number of insider purchase transactions to fetch"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(u,{htmlFor:"fetch-interval",className:"flex items-center gap-2",children:["Fetch Interval",W&&e.jsxs(Q,{variant:"secondary",className:"text-xs",children:[e.jsx(Ee,{className:"h-3 w-3 mr-1"}),"Paid Feature"]})]}),W?e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"relative",children:e.jsxs(re,{value:"daily",disabled:!0,children:[e.jsx(ce,{id:"fetch-interval","data-testid":"select-fetch-interval",className:"opacity-60",children:e.jsx(le,{placeholder:"Daily"})}),e.jsx(de,{children:e.jsx(Z,{value:"daily",children:"Daily"})})]})}),e.jsxs(be,{className:"bg-primary/5 border-primary/20",children:[e.jsx(we,{className:"h-4 w-4 text-primary"}),e.jsxs(Ce,{className:"ml-2",children:[e.jsx("span",{className:"font-medium",children:"Trial users receive daily data updates."}),e.jsx("br",{}),e.jsx("span",{className:"text-muted-foreground",children:"Upgrade to get hourly insider trading alerts and never miss a signal."}),e.jsx(Se,{href:"/purchase",children:e.jsxs(f,{variant:"default",size:"sm",className:"mt-2","data-testid":"button-upgrade-for-hourly",children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Upgrade Now"]})})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(re,{value:x,onValueChange:t=>R(t),disabled:!d,children:[e.jsx(ce,{id:"fetch-interval","data-testid":"select-fetch-interval",children:e.jsx(le,{placeholder:"Select interval"})}),e.jsxs(de,{children:[e.jsx(Z,{value:"hourly",children:"Hourly"}),e.jsx(Z,{value:"daily",children:"Daily"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"How often to fetch new insider trading data"})]})]}),e.jsxs("div",{className:"rounded-lg border bg-muted/30 p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium",children:[e.jsx(ie,{className:"h-4 w-4"}),"Data Refresh Status"]}),e.jsxs("div",{className:"grid gap-2 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Your Plan:"}),e.jsx(Q,{variant:c?"default":"secondary","data-testid":"badge-subscription-type",children:c?e.jsxs(e.Fragment,{children:[e.jsx(ne,{className:"h-3 w-3 mr-1"}),"Paid (Hourly Updates)"]}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"h-3 w-3 mr-1"}),"Trial (Daily Updates)"]})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Last Data Refresh:"}),e.jsx("span",{className:"font-medium","data-testid":"text-last-refresh",children:h?Te(h,{addSuffix:!0}):"Never"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Next Refresh:"}),e.jsx("span",{className:"font-medium","data-testid":"text-next-refresh",children:w.canRefresh?e.jsxs(Q,{variant:"outline",className:"text-green-600 border-green-600",children:[e.jsx(fe,{className:"h-3 w-3 mr-1"}),"Ready Now"]}):e.jsxs("span",{className:"text-amber-600",children:["In ",w.timeUntilRefresh]})})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{id:"previous-day-only",checked:P,onCheckedChange:H,disabled:!d,"data-testid":"switch-previous-day-only"}),e.jsx(u,{htmlFor:"previous-day-only",className:"cursor-pointer",children:"Fetch previous day's transactions only"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"insider-titles",children:"Filter by Insider Titles (optional)"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:["CEO","CFO","Director","President","Officer","VP","Chairman"].map(t=>e.jsx(f,{type:"button",size:"lg",variant:g.includes(t)?"default":"outline",onClick:()=>{g.includes(t)?D(g.filter(s=>s!==t)):D([...g,t])},disabled:!d,"data-testid":`button-toggle-title-${t.toLowerCase()}`,children:t},t))}),g.length>0&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Filtering by: ",g.join(", ")]}),g.length===0&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"No filter - all insider titles will be included"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"min-transaction-value",children:"Minimum Transaction Value (optional)"}),e.jsx(N,{id:"min-transaction-value",type:"number",min:"0",step:"1000",placeholder:"e.g., 100000",value:b||"",onChange:t=>A(t.target.value?parseInt(t.target.value):null),disabled:!d,"data-testid":"input-min-transaction-value"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Filter transactions below this dollar amount (leave empty for no minimum)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"min-market-cap",children:"Minimum Market Cap (millions)"}),e.jsx(N,{id:"min-market-cap",type:"number",min:"0",step:"100",placeholder:"500",value:V,onChange:t=>{const s=t.target.value===""?500:parseInt(t.target.value);$(isNaN(s)?500:s)},disabled:!d,"data-testid":"input-min-market-cap"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Only include companies with market cap above this value (in millions). Default $500M filters out micro-cap stocks. Set to 0 to include all sizes."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"options-deal-threshold",children:"Options Deal Filter (%)"}),e.jsx(N,{id:"options-deal-threshold",type:"number",min:"0",max:"100",step:"1",placeholder:"15",value:U,onChange:t=>Y(parseInt(t.target.value)||15),disabled:!d,"data-testid":"input-options-deal-threshold"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Insider purchase price must be at least this % of current market price. Set to 0 to disable filter. Default 15% filters out likely stock options deals."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"min-community-engagement",children:"Minimum Community Engagement"}),e.jsx(N,{id:"min-community-engagement",type:"number",min:"0",step:"1",placeholder:"10",value:E,onChange:t=>B(parseInt(t.target.value)||10),disabled:!d,"data-testid":"input-min-community-engagement"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Minimum number of comments required for a stock to appear in the Community section. Default 10 shows only stocks with active discussions."})]})]}),e.jsxs(f,{type:"submit",disabled:I.isPending,"data-testid":"button-save-openinsider-config",children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),I.isPending?"Saving...":"Save Configuration"]})]})})]}),e.jsxs(y,{"data-testid":"card-openinsider-info",children:[e.jsxs(v,{children:[e.jsx(S,{children:"Insider Trading Data Source"}),e.jsx(L,{children:"Automated collection from SEC regulatory filings"})]}),e.jsxs(T,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Automated Data Collection"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"The system automatically collects insider trading data from SEC regulatory filings every hour, focusing on purchase transactions that indicate insider confidence."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Data Processing"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Each transaction is analyzed to extract:"}),e.jsxs("ul",{className:"text-xs text-muted-foreground list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Stock ticker symbols"}),e.jsx("li",{children:"Purchase price and quantity"}),e.jsx("li",{children:"Filing date (when information became public)"}),e.jsx("li",{children:"Company and insider names"})]})]}),(i==null?void 0:i.lastSync)&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Last Sync"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(i.lastSync).toLocaleString()})]}),(i==null?void 0:i.lastError)&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-red-600",children:"Last Error"}),e.jsx("p",{className:"text-xs text-muted-foreground text-red-600",children:i.lastError})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Reliability"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Built-in retry logic with exponential backoff ensures reliable data collection even during network issues or website throttling."})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs(f,{onClick:()=>C.mutate(),disabled:C.isPending||!(i!=null&&i.enabled),"data-testid":"button-fetch-openinsider-now",children:[e.jsx(ee,{className:`h-4 w-4 mr-2 ${C.isPending?"animate-spin":""}`}),C.isPending?"Fetching...":"Fetch Now"]})})]})]})]})}export{Qe as default};
