import{Y as I,cA as P,d as z,r as g,u as L,aa as T,e as x,j as e,C as h,f as p,R as q,g as f,a8 as j,h as b,T as M,cd as R,B as c,ab as G,ac as v,ad as w,ae as y,af as N,W as S,ag as k,p as _,s as B,G as V,ai as Y,b as F,bM as D,b_ as A}from"./index-DI4YInPS.js";import{s as H}from"./moving_signal_boomerang_slow-BYkUuerR.js";import{S as O}from"./shield-alert-D5gOe91c.js";import{C as W}from"./circle-alert-D8Fr0CHp.js";const U=D({email:A().email("Invalid email address"),password:A().min(1,"Password is required")});function J(){I();const d=P(),{toast:i}=z(),[m,u]=g.useState(!1),{data:t}=L({queryKey:["/api/auth/google/configured"]});g.useEffect(()=>{const a=new URLSearchParams(d).get("error");a&&(i({title:"Sign In Failed",description:{google_auth_failed:"Google sign-in failed. Please try again.",missing_code:"Authentication was cancelled. Please try again.",invalid_state:"Security check failed. Please try again.",trial_expired:"Your free trial has expired. Please subscribe to continue.",subscription_required:"An active subscription is required to access the dashboard.",session_error:"Session error. Please try again."}[a]||"An error occurred during sign-in.",variant:"destructive"}),window.history.replaceState({},"","/login"))},[d,i]);const C=async()=>{try{u(!0);const s=await fetch("/api/auth/google/url"),a=await s.json();if(!s.ok)throw new Error(a.error||"Failed to initialize Google Sign-In");window.location.href=a.url}catch(s){i({title:"Google Sign-In Error",description:s.message||"Failed to start Google Sign-In",variant:"destructive"}),u(!1)}},o=T({resolver:Y(U),defaultValues:{email:"",password:""}}),l=x({mutationFn:async s=>{const a=await F("POST","/api/auth/login",s);if(!a.ok){const r=await a.json(),n=new Error(r.error||"Login failed");throw n.trialExpired=r.trialExpired,n.subscriptionStatus=r.subscriptionStatus,n.emailVerificationRequired=r.emailVerificationRequired,n.email=r.email,n}return a.json()},onSuccess:async s=>{if(s.subscriptionStatus==="inactive"){i({title:"Subscription Required",description:"Please subscribe to access your account.",variant:"destructive"});return}i({title:"Welcome back!",description:s.subscriptionStatus==="trial"?"Enjoy your free trial!":"You have successfully logged in."}),window.location.href="/"},onError:s=>{s.emailVerificationRequired?i({title:"Email Verification Required",description:s.message||"Please verify your email before logging in.",variant:"destructive"}):s.trialExpired?i({title:"Free Trial Expired",description:"Your 30-day trial has ended. Subscribe now to continue using signal2.",variant:"destructive"}):i({title:"Login failed",description:s.message||"Invalid email or password.",variant:"destructive"})}});x({mutationFn:async s=>(await F("POST","/api/auth/resend-verification",{email:s})).json(),onSuccess:()=>{i({title:"Email Sent",description:"A new verification email has been sent to your inbox."})},onError:s=>{i({title:"Failed to resend",description:s.message||"Please try again later.",variant:"destructive"})}});const E=s=>{console.log("Login form submitted:",{email:s.email}),l.mutate(s)};return e.jsxs("div",{className:"min-h-screen flex items-center justify-center p-4 relative",style:{backgroundImage:`url(${H})`,backgroundSize:"cover",backgroundPosition:"center bottom",backgroundRepeat:"no-repeat"},children:[e.jsx("div",{className:"absolute inset-0 bg-background/85 dark:bg-background/90"}),e.jsxs("div",{className:"w-full max-w-5xl grid md:grid-cols-2 gap-6 relative z-10",children:[e.jsxs(h,{className:"md:flex md:flex-col md:justify-center border-0 shadow-none bg-transparent",children:[e.jsxs(p,{className:"pb-2",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(q,{className:"h-10 w-10 text-primary"}),e.jsx(f,{className:"text-4xl font-bold tracking-tight",children:"signal2"})]}),e.jsx(j,{className:"text-lg text-foreground/80",children:"Find high-conviction trades by following what insiders know"})]}),e.jsx(b,{className:"pt-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"rounded-lg bg-primary/10 p-2.5 flex-shrink-0",children:e.jsx(M,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-1",children:"Insider Trading Signals"}),e.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:"SEC insider transactions scored by AI on a 0-100 scale. Filter noise and surface the strongest opportunities."})]})]}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"rounded-lg bg-primary/10 p-2.5 flex-shrink-0",children:e.jsx(R,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-1",children:"AI Analysis on Your Watchlist"}),e.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:"Follow stocks and get daily AI briefs with updated recommendations. Track positions with P&L."})]})]}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"rounded-lg bg-primary/10 p-2.5 flex-shrink-0",children:e.jsx(O,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-1",children:"Smart Alerts"}),e.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:"Set rules to get notified when it matters. Never miss a signal change or high-score opportunity."})]})]})]})})]}),e.jsxs(h,{children:[e.jsxs(p,{className:"text-center",children:[e.jsx(f,{className:"text-2xl",children:"Sign In"}),e.jsx(j,{children:"Access your trading dashboard"})]}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs(c,{type:"button",variant:"outline",className:"w-full gap-2 bg-white dark:bg-zinc-900 border-zinc-200 dark:border-zinc-700 text-zinc-700 dark:text-zinc-200 hover:bg-zinc-50 dark:hover:bg-zinc-800",onClick:C,disabled:m||!(t!=null&&t.configured),"data-testid":"button-google-signin",children:[e.jsxs("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),m?"Connecting...":"Continue with Google"]}),!(t!=null&&t.configured)&&e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"Google Sign-In is not configured"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("span",{className:"w-full border-t"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-card px-2 text-muted-foreground",children:"Or continue with email"})})]}),e.jsx(G,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(E),className:"space-y-4",children:[e.jsx(v,{control:o.control,name:"email",render:({field:s})=>e.jsxs(w,{children:[e.jsx(y,{children:"Email"}),e.jsx(N,{children:e.jsx(S,{type:"email",placeholder:"john@example.com",...s,"data-testid":"input-email",autoComplete:"email"})}),e.jsx(k,{})]})}),e.jsx(v,{control:o.control,name:"password",render:({field:s})=>e.jsxs(w,{children:[e.jsx(y,{children:"Password"}),e.jsx(N,{children:e.jsx(S,{type:"password",placeholder:"••••••••",...s,"data-testid":"input-password",autoComplete:"current-password"})}),e.jsx(k,{})]})}),e.jsx(c,{type:"submit",className:"w-full touch-manipulation",disabled:l.isPending,"data-testid":"button-login",onClick:s=>{console.log("Login button clicked"),s.currentTarget.closest("form")||console.error("Form element not found")},children:l.isPending?"Signing in...":"Sign In"})]})}),e.jsxs(_,{children:[e.jsx(W,{className:"h-4 w-4"}),e.jsx(B,{className:"text-sm",children:"New users get a 30-day free trial. An active subscription is required after trial expires."})]}),e.jsxs("div",{className:"text-center pt-4 border-t",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Don't have an account?"}),e.jsx(c,{variant:"outline",asChild:!0,"data-testid":"button-create-account",children:e.jsx(V,{href:"/signup",children:"Create New Account"})})]})]})]})]})]})}export{J as default};
